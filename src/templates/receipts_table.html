<div id="receipts-table" class="table-container">
    <div class="flex space-x-4 mb-4">
      <input type="date" id="start-date" class="border rounded p-2" hx-get="/dashboard/receipts-table" hx-target="#receipts-table" hx-swap="outerHTML" hx-include="[name='start-date'],[name='end-date']" name="start-date">
      <input type="date" id="end-date" class="border rounded p-2" hx-get="/dashboard/receipts-table" hx-target="#receipts-table" hx-swap="outerHTML" hx-include="[name='start-date'],[name='end-date']" name="end-date">
      <select name="sort-by" hx-get="/dashboard/receipts-table" hx-target="#receipts-table" hx-swap="outerHTML" class="border rounded p-2">
        <option value="created_at">Sort by Date</option>
        <option value="total_amount">Sort by Amount</option>
        <option value="total_items">Sort by Items</option>
      </select>
      <select name="sort-order" hx-get="/dashboard/receipts-table" hx-target="#receipts-table" hx-swap="outerHTML" class="border rounded p-2">
        <option value="desc">Descending</option>
        <option value="asc">Ascending</option>
      </select>
    </div>
    {% if uploaded_receipts %}
      <table class="table w-full">
        <thead>
          <tr class="table-header">
            <th class="table-cell"><i class="fas fa-id-badge mr-1"></i>ID</th>
            <th class="table-cell"><i class="fas fa-dollar-sign mr-1"></i>Total Amount</th>
            <th class="table-cell"><i class="fas fa-cubes mr-1"></i>Total Items</th>
            <th class="table-cell"><i class="fas fa-calendar-alt mr-1"></i>Created At</th>
            <th class="table-cell"><i class="fas fa-cog mr-1"></i>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for receipt in uploaded_receipts %}
            <tr class="table-row">
              <td class="table-cell">{{ receipt.id }}</td>
              <td class="table-cell">${{ receipt.total_amount | round(2) }}</td>
              <td class="table-cell">{{ receipt.total_items }}</td>
              <td class="table-cell">{{ receipt.created_at }}</td>
              <td class="table-cell">
                <button class="text-blue-500 hover:underline" hx-get="/dashboard/receipt-items/{{ receipt.id }}" hx-target="#items-{{ receipt.id }}" hx-swap="outerHTML">
                  View Items
                </button>
                <form action="/dashboard/delete-receipt/{{ receipt.id }}" method="POST" class="inline">
                   
                  <button type="submit" class="text-red-500 hover:underline" onclick="return confirm('Delete this receipt?')">
                    Delete
                  </button>
                </form>
              </td>
            </tr>
            <tr id="items-{{ receipt.id }}"></tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="no-items text-center text-gray-500 py-4">
        <i class="fas fa-exclamation-circle mr-2"></i>No receipts found. Upload a receipt to start tracking!
      </p>
    {% endif %}
  </div>
  <script>

document.addEventListener('htmx:configRequest', (event) => {
    const csrfToken = document.querySelector('input[name="csrf_token"]').value;
    event.detail.headers['X-CSRFToken'] = csrfToken;
});
  </script>
  